Jarvis 的逆向题 DD-Android Easy
==============================
>DDCTF android Easy
一道关于apk的逆向题,直接用APK IDE打开
反编译后查看java源码
>在 com/didi_ctf/flagapp下发现FlagActivity.class文件
其中有两个重要的函数,两个字节数组p,q
``` 用来加密的函数
 private String i()
  {
    int j = 0;
    byte[] arrayOfByte1 = new byte[p.length]; 
    int i = 0;
    while (i < arrayOfByte1.length)
    {
      arrayOfByte1[i] = ((byte)(p[i] ^ q[i]));
      i += 1;
    }
    int k = arrayOfByte1[0];
    i = 0;
    while (arrayOfByte1[(k + i)] != 0) {
      i += 1;
    }
    byte[] arrayOfByte2 = new byte[i];
    while (j < i)
    {
      arrayOfByte2[j] = arrayOfByte1[(k + j)];
      j += 1;
    }
    return new String(arrayOfByte2);
  }
  ```
  
onClickTest函数,点击时候的反馈函数
其中最重要的就是if判断
```
if (this.n.getText().toString().equals(i()))
```
我们发现就是比较输入的字符串与i函数返回的字符串是否相同.

用python写下脚本
```
p = [-40, -62, 107, 66, -126, 103, -56, 77, 122,
     -107, -24, -127, 72, -63, -98, 64, -24, -5,
     -49, -26, 79, -70, -26, -81, 120, 25, 111,
     -100, -23, -9, 122, -35, 66, -50, -116, 3,
     -72, 102, -45, -85, 0, 126, -34, 62, 83,
     -34, 48, -111, 61, -9, -51, 114, 20, 81,
     -126, -18, 27, -115, -76, -116, -48, -118,
     -10, -102, -106, 113, -104, 98, -109, 74,
     48, 47, -100, -88, 121, 22, -63, -32, -20,
     -41, -27, -20, -118, 100, -76, 70, -49, -39,
     -27, -106, -13, -108, 115, -87, -1, -22, -53,
     21, -100, 124, -95, -40, 62, -69, 29, 56, -53,
     85, -48, 25, 37, -78, 11, -110, -24, -120, -82,
     6, -94, -101 ]
q = [ -57, -90, 53, -71, -117, 98, 62, 98, 101, -96,
      36, 110, 77, -83, -121, 2, -48, 94, -106, -56,
      -49, -80, -1, 83, 75, 66, -44, 74, 2, -36, -42,
      -103, 6, -115, -40, 69, -107, 85, -78, -49, 54,
      78, -26, 15, 98, -70, 8, -90, 94, -61, -84, 64,
      112, 51, -29, -34, 126, -21, -126, -71, -31, -24,
      -60, -2, -81, 66, -84, 85, -91, 10, 84, 70, -8, -63,
      26, 126, -76, -104, -123, -71, -126, -62, -23, 11,
      -39, 70, 14, 59, -101, -39, -124, 91, -109, 102, -49,
      21, 105, 0, 37, -128, -57, 117, 110, -115, -86, 56,
      25, -46, -55, 7, -125, 109, 76, 104, -15, 82, -53,
      18, -28, -24 ]
aob =[]
for i in range(0,len(p)):
    aob.append(0)
i = 0
while i <len(p):
    aob[i] =p[i] ^ q[i]
    i += 1

k = aob[0]
i = 0
while aob[k + i] != 0:
    i += 1
j = 0
aob2=[]
for i in range(0,i+1):
    aob2.append(0)
while (j < i):
    aob2[j] =aob[k+j]
    j += 1

ans =''
for c in aob2:
    ans += chr(c)

print(ans)
```
对到最后的答案
_DDCTF-3ad60811d87c4a2dba0ef651b2d93476@didichuxing.com_